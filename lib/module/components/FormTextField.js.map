{"version":3,"sources":["FormTextField.tsx"],"names":["React","useEffect","useFormContext","Controller","TextField","FormTextField","forwardRef","props","ref","name","rules","validationLength","formatter","onBlur","onValid","disabled","restOfProps","control","formState","trigger","watch","value","validate","isValid","length","field","errors","message","event","text","formatted","onChange"],"mappings":";;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,SAASC,cAAT,EAAyBC,UAAzB,QAA4D,iBAA5D;AAEA,OAAOC,SAAP,MAAsB,aAAtB;AAYA,MAAMC,aAAa,gBAAGL,KAAK,CAACM,UAAN,CAAmC,CAACC,KAAD,EAAQC,GAAR,KAAgB;AACvE,QAAM;AACJC,IAAAA,IADI;AAEJC,IAAAA,KAFI;AAGJC,IAAAA,gBAAgB,GAAG,CAHf;AAIJC,IAAAA,SAJI;AAKJC,IAAAA,MALI;AAMJC,IAAAA,OANI;AAOJC,IAAAA,QAPI;AAQJ,OAAGC;AARC,MASFT,KATJ;AAUA,QAAM;AAAEU,IAAAA,OAAF;AAAWC,IAAAA,SAAX;AAAsBC,IAAAA,OAAtB;AAA+BC,IAAAA;AAA/B,MAAyClB,cAAc,EAA7D;AACA,QAAMmB,KAAK,GAAGD,KAAK,CAACX,IAAD,CAAnB;AAEAR,EAAAA,SAAS,CAAC,MAAM;AACd,mBAAeqB,QAAf,GAA0B;AACxB,YAAMC,OAAO,GAAG,MAAMJ,OAAO,CAACV,IAAD,CAA7B;AACA,UAAIc,OAAJ,EAAaT,OAAO,SAAP,IAAAA,OAAO,WAAP,YAAAA,OAAO;AACrB;;AAED,QAAIO,KAAK,CAACG,MAAN,IAAgBb,gBAApB,EAAsC;AACpCW,MAAAA,QAAQ;AACT;AACF,GATQ,EASN,CAACD,KAAD,EAAQZ,IAAR,EAAcE,gBAAd,EAAgCQ,OAAhC,CATM,CAAT,CAduE,CAuB1B;;AAE7C,MAAIJ,QAAJ,EAAc;AACZ,WAAO,IAAP;AACD;;AAED,sBACE,oBAAC,UAAD;AACE,IAAA,OAAO,EAAEE,OADX;AAEE,IAAA,MAAM,EAAE,CAAC;AAAEQ,MAAAA;AAAF,KAAD;AAAA;;AAAA,0BACN,oBAAC,SAAD,CACE;AACA;AAFF,qBAGMT,WAHN;AAIE,QAAA,QAAQ,EAAED,QAJZ;AAKE,QAAA,GAAG,EAAEP,GALP;AAME,QAAA,MAAM,EAAG,aAAYC,IAAK,EAN5B;AAOE,QAAA,SAAS,2BAAES,SAAS,CAACQ,MAAV,CAAiBjB,IAAjB,CAAF,0DAAE,sBAAwBkB,OAPrC;AAQE,QAAA,MAAM,EAAGC,KAAD,IAAW;AACjB,cAAIb,QAAJ,EAAc;AACZ;AACD;;AACDU,UAAAA,KAAK,CAACZ,MAAN;AACAA,UAAAA,MAAM,SAAN,IAAAA,MAAM,WAAN,YAAAA,MAAM,CAAGe,KAAH,CAAN;AACD,SAdH;AAeE,QAAA,YAAY,EAAGC,IAAD,IAAU;AACtB,cAAId,QAAJ,EAAc;AACZ;AACD;;AACD,gBAAMe,SAAS,GAAGlB,SAAS,GAAGA,SAAS,CAACa,KAAK,CAACJ,KAAP,EAAcQ,IAAd,CAAZ,GAAkCA,IAA7D;AACAJ,UAAAA,KAAK,CAACM,QAAN,CAAeD,SAAf;;AACA,cAAIvB,KAAK,CAACwB,QAAV,EAAoB;AAClBxB,YAAAA,KAAK,CAACwB,QAAN,CAAeD,SAAf,EAA0BD,IAA1B;AACD;AACF,SAxBH;AAyBE,QAAA,KAAK,EAAEJ,KAAK,CAACJ;AAzBf,SADM;AAAA,KAFV;AA+BE,IAAA,IAAI,EAAEZ,IA/BR;AAgCE,IAAA,KAAK,EAAEC;AAhCT,IADF;AAoCD,CAjEqB,CAAtB;AAmEA,eAAeL,aAAf","sourcesContent":["import React, { useEffect } from 'react'\nimport { useFormContext, Controller, RegisterOptions } from 'react-hook-form'\nimport { TextInput } from 'react-native'\nimport TextField from './TextField'\n\ntype Props = React.ComponentProps<typeof TextField> & {\n  name: string\n  rules: RegisterOptions\n  validationLength?: number\n  formatter?: (oldValue: string, newValue: string) => string\n  onValid?: () => void\n  onChange?: (formatted: string, text: string) => void\n  disabled: boolean | null\n}\n\nconst FormTextField = React.forwardRef<TextInput, Props>((props, ref) => {\n  const {\n    name,\n    rules,\n    validationLength = 1,\n    formatter,\n    onBlur,\n    onValid,\n    disabled,\n    ...restOfProps\n  } = props\n  const { control, formState, trigger, watch } = useFormContext()\n  const value = watch(name)\n\n  useEffect(() => {\n    async function validate() {\n      const isValid = await trigger(name)\n      if (isValid) onValid?.()\n    }\n\n    if (value.length >= validationLength) {\n      validate()\n    }\n  }, [value, name, validationLength, trigger]) // eslint-disable-line react-hooks/exhaustive-deps\n\n  if (disabled) {\n    return null;\n  }\n\n  return (\n    <Controller\n      control={control}\n      render={({ field }) => (\n        <TextField\n          // passing everything down to TextField\n          // to be able to support all TextInput props\n          {...restOfProps}\n          disabled={disabled}\n          ref={ref}\n          testID={`TextField.${name}`}\n          errorText={formState.errors[name]?.message}\n          onBlur={(event) => {\n            if (disabled) {\n              return;\n            }\n            field.onBlur()\n            onBlur?.(event)\n          }}\n          onChangeText={(text) => {\n            if (disabled) {\n              return;\n            }\n            const formatted = formatter ? formatter(field.value, text) : text\n            field.onChange(formatted)\n            if (props.onChange) {\n              props.onChange(formatted, text)\n            }\n          }}\n          value={field.value}\n        />\n      )}\n      name={name}\n      rules={rules}\n    />\n  )\n})\n\nexport default FormTextField\n"]}